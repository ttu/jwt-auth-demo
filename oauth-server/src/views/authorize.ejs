<!DOCTYPE html>
<html>
  <head>
    <title>Authorize Access</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
      }
      .container {
        border: 1px solid #ddd;
        padding: 20px;
        border-radius: 5px;
        background-color: #f9f9f9;
      }
      .info {
        margin-bottom: 20px;
      }
      .info p {
        margin: 5px 0;
      }
      .button {
        background-color: #4caf50;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
      }
      .button:hover {
        background-color: #45a049;
      }
      .explanation {
        background-color: #f0f0f0;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
        font-size: 14px;
        line-height: 1.5;
      }
      .explanation h3 {
        margin-top: 0;
        color: #333;
      }
      .explanation ul {
        margin: 10px 0;
        padding-left: 20px;
      }
      .explanation li {
        margin-bottom: 8px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h2>Authorize Access</h2>

      <div class="explanation">
        <h3>About This Page</h3>
        <p>This is a demonstration of the OAuth 2.0 Authorization Code Flow. In a real-world scenario:</p>
        <ul>
          <li>You would be redirected to the actual service provider (like Google, Microsoft, etc.)</li>
          <li>The page would show the official branding and security information of the provider</li>
          <li>You would need to log in with your actual account credentials</li>
          <li>The permissions requested would be clearly explained with their implications</li>
          <li>You might see additional security measures like 2FA prompts</li>
        </ul>
        <p>This demo simulates that process to show how OAuth works without requiring real credentials.</p>
      </div>

      <div class="info">
        <p><strong>Application:</strong> <%= provider %> Client</p>
        <p><strong>Requested Permissions:</strong> <%= scope %></p>
        <p><strong>Redirect URI:</strong> <%= redirect_uri %></p>
      </div>

      <form action="/oauth/authorize/confirm" method="POST" enctype="application/x-www-form-urlencoded">
        <input type="hidden" name="response_type" value="<%= response_type %>" />
        <input type="hidden" name="client_id" value="<%= client_id %>" />
        <input type="hidden" name="redirect_uri" value="<%= redirect_uri %>" />
        <input type="hidden" name="scope" value="<%= scope %>" />
        <input type="hidden" name="state" value="<%= state %>" />
        <input type="hidden" name="provider" value="<%= provider %>" />
        <button type="submit" class="button">Authorize</button>
      </form>
    </div>
  </body>
</html>
